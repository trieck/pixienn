model:
  batch: 1
  channels: 3
  height: 320
  width: 320

  max_batches: 100000
  momentum: 0.9
  decay: 0.0005

  adam:
    enabled: False
    beta1: 0.9
    beta2: 0.999
    epsilon: 1e-8

  augmentation:
    enabled: False
    flip: True
    jitter: 0.2
    hue: 0.2
    saturation: 0.75
    exposure: 0.75

  gradient_rescale:
    enabled: True
    threshold: 100.0

  gradient_clipping:
    enabled: True
    value: 10.0

  validation:
    enabled: False
    interval: 1000
    batches: 100
    threshold: 0.5

  save_weights_interval: 1000
  write_metrics_interval: 50

  learning_rate:
    burn_in:
      batches: 200
      power: 2.0

    initial_learning_rate: 0.001
    policy: sigmoid

    sigmoid:
      target_learning_rate: 0.00001
      factor: 5.0

    inverse:
      gamma: 0.00001
      power: 4

    stepped:
      steps: [ -1, 100, 20000, 30000 ]
      scales: [ 0.1, 10, 0.1, 0.1 ]

  layers:
    # Input: 320x320x3

    # Initial conv: preserves resolution
    - type: conv
      filters: 16
      kernel: 3
      stride: 1
      pad: True
      activation: mish
      batch_normalize: True
      # Output: 320x320x16

    # Depthwise downsampling block #1
    - type: conv
      filters: 16
      kernel: 3
      stride: 2
      pad: True
      groups: 16
      activation: mish
      batch_normalize: True
      # Output: 160x160x16

    # Pointwise conv to mix channels
    - type: conv
      filters: 32
      kernel: 1
      stride: 1
      pad: False
      activation: mish
      batch_normalize: True
      # Output: 160x160x32

    # Depthwise downsampling block #2
    - type: conv
      filters: 32
      kernel: 3
      stride: 2
      pad: True
      groups: 32
      activation: mish
      batch_normalize: True
      # Output: 80x80x32 (final downsampling!)

    # Depth-preserving feature extraction block 1
    - type: conv
      filters: 64
      kernel: 1
      stride: 1
      pad: False
      activation: mish
      batch_normalize: True
      # Output: 80x80x64

    # Spatial mixing
    - type: conv
      filters: 64
      kernel: 3
      stride: 1
      pad: True
      activation: mish
      batch_normalize: True
      # Output: 80x80x64

    # Depth-preserving feature extraction block 2
    - type: conv
      filters: 96
      kernel: 3
      stride: 1
      pad: True
      activation: mish
      batch_normalize: True
      # Output: 80x80x96

    # Detection projection layer
    - type: conv
      filters: 24  # 20 classes + 2 size + 2 offset
      kernel: 1
      stride: 1
      pad: False
      activation: linear
      # Output: 80x80x24

    # CenterNet detection head
    - type: centernet
      stride: 4
      log_interval: 50
